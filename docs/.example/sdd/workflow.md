# ワークフロー

## Preparation(準備)

- 新規リポジトリ作成
- 過去のプロジェクトデータをコピー
- SDDドキュメントをコピー（docs/.example/sdd/）

## AIAnalysis(AI分析)

- SDDドキュメントをAIに読ませる
  - design-document.md: 基本思想と設計方針
  - workflow.md: ワークフロー
  - directory-example.md: ディレクトリ構造
  - specification-example.md: 仕様書記述ルール
- 過去PJデータをAIに読ませる
  - プロジェクト全体の構造を理解
  - 既存コード、コンポーネント、ページを分析
  - 既存のデザインシステム、アーキテクチャを把握

## CreatePlan(プラン作成)

- /docs/plan/にプランドキュメントを作成
  - design_upgrade_plan.md: デザインバージョンアッププラン
  - frontend_architecture_upgrade_plan.md: 設計バージョンアップ&リファクタリングプラン
  - api_mocking_plan.md: APIモック化プラン
- 各プランはSDDで仕様書を作成するための指針
- ユーザー確認を待つ

## CreateDocumentation(ドキュメント作成)

- /docsディレクトリ作成
  - 過去PJを参考にSDDドキュメントに準じた構造を作成
  - directory-example.md を参照
  - /docs/ui/, /docs/features/ 等の構造を作成
- ユーザー確認を待つ

## CreateSpecification(仕様書作成)

- SDD仕様書作成
  - /docs/ui/variables/: デザイントークン仕様書
  - /docs/ui/components/: コンポーネント仕様書
  - /docs/ui/pages/: ページ仕様書
  - /docs/features/: 機能仕様書
  - specification-example.md を参照
  - 記述ルール遵守: 簡潔、具体的、実用的
  - 今回はimage.pngは無し
- ユーザー確認を待つ

## VerifySpecification(仕様書確認)

- 過去PJ＆プランと照らし合わせて必要な仕様書がすべて揃っているか確認
  - 過去PJのコンポーネント、ページ、機能を全て確認
  - プランドキュメント（design_upgrade_plan.md、frontend_architecture_upgrade_plan.md、api_mocking_plan.md）と照合
  - 不足している仕様書を特定
- 必要があれば修正
  - 不足している仕様書を作成
  - 仕様書の追加・削除を実施
- 過去PJ＆プランと照らし合わせて仕様書の内容が正しく記述されているか確認
  - 既存コードと仕様書の内容を照合
  - プランドキュメントの要件と仕様書の内容を照合
  - 数値、状態、動作の正確性を確認
  - Tailwind CSSへの変換が正しく記述されているか確認
- 必要があれば修正
  - 誤りや不足を修正
  - 仕様書の内容を更新
- 再度過去PJ＆プランと照らし合わせて確認
  - 既存コードと仕様書の内容を再照合
  - プランドキュメントの要件と仕様書の内容を再照合
  - 数値、状態、動作の正確性を再確認
- 完成度をチェック
  - 仕様書の完成度を評価
  - 不足や課題を特定
- 完成度が低い場合: 修正 → 確認（上記の確認と完成度チェックを繰り返す）
- 完成度が十分な場合: 変更がされた箇所の説明と、完成度の報告
  - 修正した箇所の説明
  - 仕様書の完成度報告
  - レポート作成: /docs/report/{日付}_VERIFY_SPECIFICATION_REPORT.md
    - 確認結果サマリー
    - 作成済み仕様書の一覧
    - 未作成仕様書の一覧
    - 仕様書の内容確認結果
    - 修正した箇所の説明
    - 完成度評価
    - 次のステップ
- ユーザー確認を待つ

## BackupExistingProject(既存プロジェクトのバックアップ)

- 過去PJのバックアップ
  - バックアップ先: /.old/{日付}/backup/
  - 既存データ(コンポーネント、ページ、関連ファイル)を全てコピー
- 過去PJの仕様書の作成
  - バックアップ先: /.old/{日付}/specification/
  - AIに既存コードを読ませて specification.md を生成
  - SDDドキュメントに準じた仕様書を作成
- 過去PJのテストコード作成
  - バックアップ先: /.old/{日付}/tests/
  - 既存の動作を保証するテストを生成
- ユーザー確認を待つ

## Cleanup(クリーンアップ)

- 現PJからの削除ファイル選定
  - 今行ってる改修に関連するもののみを選定
  - バックアップにあるか確認
  - 削除対象のファイルリストを提示
- ユーザー確認を待つ
- 削除実行
  - バックアップ済みであることを確認してから削除
- ユーザー確認を待つ

## Implementation(実装生成)

- /srcディレクトリ作成
  - /docsディレクトリと1対1対応する構造を作成
  - directory-example.md を参照
- /srcテストコード作成
  - /srcディレクトリで作成したディレクトリ内にテストコードを作成
  - 仕様書から必要なテストケースを抽出
  - テスト駆動で実装
- ユーザー確認を待つ
- /srcコード生成
  - /srcディレクトリで作成したディレクトリ内にコードを生成
  - 仕様とテストコードから、コードを作成
  - フロントのui-kitであれば全画面のハリボテページを作成
    - /showcase/ui-kit/{component-name} に配置
  - ui-featuresの挙動がわかるモック付きのハリボテも作成
    - /showcase/ui-features/{feature-name} に配置

## Validation(検証)

- テスト実行
  - テストコードを走らせ、実装チェックをする
  - 全テスト通過が必須
- ユーザー確認を待つ
- 仮想環境立ち上げ
  - ローカル起動できるようセットアップ
  - 必要なパッケージインストール確認
- ユーザー確認を待つ
- ブラウザで動作チェック
  - localhost でハリボテページを確認
  - 各状態(hover, active, disabled等)の動作確認
  - バックアップにある仕様やテストコードから、新しい実装が不足なく正しく作られているか確認
    - 既存機能の後退がないことを確認